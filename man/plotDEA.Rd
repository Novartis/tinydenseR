% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.R
\name{plotDEA}
\alias{plotDEA}
\title{Plot Differential Expression Analysis Results}
\usage{
plotDEA(
  .lm.obj,
  .dea.obj,
  .coefs = colnames(x = .dea.obj$coefficients),
  .order.by = "clustering",
  .markers = colnames(x = .lm.obj$graph[[.order.by]]$median.exprs),
  .q = 0.1,
  .row.space.scaler = 0.2,
  .col.space.scaler = 0.065,
  .label.substr.rm = ""
)
}
\arguments{
\item{.lm.obj}{A tinydenseR object processed through \code{get.map()}.}

\item{.dea.obj}{Differential expression results from \code{get.dea()}.}

\item{.coefs}{Character vector of coefficient names to plot. Defaults to all coefficients in
\code{.dea.obj}.}

\item{.order.by}{Character: "clustering" (default) or "celltyping" - order rows by mean expression
in these groups.}

\item{.markers}{Character vector of feature names (genes/proteins) to plot. Defaults to features
shown in cluster/celltype heatmap (top PC contributors for RNA, all markers for cytometry).}

\item{.q}{Numeric adjusted p-value threshold for significance marking (default 0.1).}

\item{.row.space.scaler}{Numeric row height scaling (default 0.2 inches per feature).}

\item{.col.space.scaler}{Numeric column width scaling (default 0.065 inches per coefficient).}

\item{.label.substr.rm}{Character substring to remove from labels (default "").}
}
\value{
A \code{ggplot} heatmap showing effect sizes (log2 fold changes for RNA, estimated
differences for cytometry) with point size indicating adjusted p-values and asterisks marking
features meeting the significance threshold.
}
\description{
Visualizes differential expression results as a heatmap showing log fold changes for genes/markers
across coefficients. Rows ordered by cluster/celltype expression patterns, with significance
indicated by asterisks. Helps identify which features drive population-level changes.
}
\details{
This function shows which genes/markers are differentially expressed between conditions,
organized by their expression patterns across clusters/cell types. The ordering helps identify:
\itemize{
\item Marker genes defining specific populations
\item Broadly vs. specifically regulated features
\item Cell type-specific transcriptional responses
}

For RNA data, typically shows top PC-loading genes. For cytometry, shows all markers.
}
\examples{
\dontrun{
# After DEA
design <- model.matrix(~ Condition, data = .meta)
dea <- get.dea(lm.cells, .design = design)

# Heatmap of DE genes
plotDEA(lm.cells, dea, .coefs = "ConditionB", .order.by = "clustering")

# Focus on specific markers
plotDEA(lm.cells, dea, 
        .coefs = "ConditionB",
        .markers = c("CD4", "CD8A", "CD3D"))
}

}
\seealso{
\code{\link{get.dea}}, \code{\link{plotBeeswarm}}
}
