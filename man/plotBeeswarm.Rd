% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.R
\name{plotBeeswarm}
\alias{plotBeeswarm}
\title{Bee swarm Plot of Density Estimate Change}
\usage{
plotBeeswarm(
  .lm.obj,
  .stats.obj,
  .coefs,
  .q = 0.1,
  .q.from = "pca.weighted.q",
  .split.by = if (length(x = .coefs) > 1) "none" else "clustering",
  .swarm.title = NULL,
  .label.substr.rm = "",
  .point.size = 0.1,
  .facet.scales = "fixed",
  .row.space.scaler = 0.2,
  .col.space.scaler = 0.1,
  .panel.width = 1.5,
  .legend.position = "right",
  .perc.plot = TRUE
)
}
\arguments{
\item{.lm.obj}{A tinydenseR object processed through \code{get.map()}.}

\item{.stats.obj}{Statistical results from \code{get.stats()}.}

\item{.coefs}{Character vector of coefficient names from the design matrix to plot. Must match
column names in \code{.stats.obj$fit$coefficients}. Can plot single or multiple coefficients.}

\item{.q}{Numeric q-value threshold for significance coloring (default 0.1). Points with
q < threshold are colored by direction (red/blue), otherwise gray.}

\item{.q.from}{Character specifying q-value source: "pca.weighted.q" (default, PCA-variance weighted)
or "density.weighted.bh.fdr" (density weighted). See \code{get.stats()} for details.}

\item{.split.by}{Character controlling plot faceting: "none" (default if multiple coefficients),
"clustering" (split by clusters), or "celltyping" (split by cell types). Default "clustering"
for single coefficient.}

\item{.swarm.title}{Character plot title. If NULL and no facets, uses coefficient name.}

\item{.label.substr.rm}{Character substring to remove from axis labels (default "").}

\item{.point.size}{Numeric point size (default 0.1).}

\item{.facet.scales}{Character facet scales: "fixed" (default), "free", "free_x", "free_y".}

\item{.row.space.scaler}{Numeric scaling factor for row height when splitting (default 0.2 inches per row).}

\item{.col.space.scaler}{Numeric scaling factor for column width when splitting (default 0.1).}

\item{.panel.width}{Numeric panel width in inches when plotting multiple coefficients (default 1.5).}

\item{.legend.position}{Character: "right" (default), "bottom", "left", "top", "none".}

\item{.perc.plot}{Logical whether to show cell percentage plot alongside beeswarm (default TRUE).
Only applies when \code{.split.by != "none"}.}
}
\value{
A \code{ggplot} object (single plot) or combined plot using \code{patchwork} (when
\code{.perc.plot = TRUE} and \code{.split.by != "none"}).
}
\description{
Creates a beeswarm plot showing effect sizes (log fold changes) from differential abundance
testing, with points colored by significance. Optionally splits results by cluster or cell type
and displays mean cell percentages alongside for biological context.
}
\details{
The beeswarm layout prevents overlapping points, making it easier to assess the distribution
of effect sizes across landmarks. Red indicates significant increases (log FC > 0), blue indicates
significant decreases, and gray indicates non-significant changes.

When split by clustering/celltyping, the percentage plot shows mean cell type abundances across
samples, helping interpret whether changes occur in rare or common populations.
}
\examples{
\dontrun{
# After statistical testing
lm.cells <- setup.lm.obj(.cells = .cells, .meta = .meta) |>
  get.landmarks() |>
  get.graph() |>
  get.map()

design <- model.matrix(~ Condition + Replicate, data = .meta)
stats <- get.stats(lm.cells, .design = design)

# Basic beeswarm split by clusters
plotBeeswarm(lm.cells, stats, .coefs = "ConditionB")

# Multiple coefficients without splitting
plotBeeswarm(lm.cells, stats, 
             .coefs = c("ConditionB", "ConditionC"),
             .split.by = "none")
}

}
\seealso{
\code{\link{get.stats}}, \code{\link{plotAbundance}}
}
