% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.R
\name{scatterPlot}
\alias{scatterPlot}
\title{Scatter Plot with Feature Coloring}
\usage{
scatterPlot(
  .x.feature,
  .y.feature,
  .color.feature = NULL,
  .x.label = "",
  .y.label = "",
  .color.label = "",
  .cat.feature.color = Color.Palette[1, 1:5],
  .panel.size = c(2, 2),
  .midpoint = NULL,
  .plot.title = "",
  .legend.position = "right",
  .point.size = 0.1,
  .seed = 123
)
}
\arguments{
\item{.x.feature}{Numeric vector for x-axis values (e.g., \code{.lm.obj$scaled.lm[,"CD3"]} or
\code{.lm.obj$pca$embed[,"PC1"]}).}

\item{.y.feature}{Numeric vector for y-axis values.}

\item{.color.feature}{Optional vector for point colors. Can be numeric (continuous coloring with
diverging blue-white-red scale) or categorical (discrete colors). If \code{NULL}, all points
receive default ggplot2 coloring.}

\item{.x.label}{Character x-axis label (default "").}

\item{.y.label}{Character y-axis label (default "").}

\item{.color.label}{Character color legend label (default "").}

\item{.cat.feature.color}{Character vector of colors for categorical features
(default \code{Color.Palette[1,1:5]}). Automatically interpolated if more categories than
colors exist.}

\item{.panel.size}{Numeric vector \code{c(width, height)} in inches (default \code{c(2,2)}).}

\item{.midpoint}{Numeric midpoint for continuous color gradients. Defaults to median of
\code{.color.feature}. Useful for centering diverging scales.}

\item{.plot.title}{Character plot title (default "").}

\item{.legend.position}{Character: "right", "left", "top", "bottom", or "none" (default "right").}

\item{.point.size}{Numeric point size (default 0.1). Increase for smaller datasets.}

\item{.seed}{Integer random seed for point order randomization (default 123). Prevents systematic
overplotting of one group by another.}
}
\value{
A \code{ggplot} object.
}
\description{
Creates a 2D scatter plot with flexible x/y features and optional coloring by a third feature.
Useful for exploring relationships between any features in the tinydenseR object (scaled expression,
PCA coordinates, graph embeddings, cluster IDs, metadata, etc.).
}
\details{
This flexible plotting function enables custom visualizations beyond the standard \code{plotPCA}
and \code{plotUMAP} interfaces. Use cases include:
\itemize{
\item Plotting Laplacian Eigenmap coordinates from \code{.lm.obj$graph$LE$embed}
\item Exploring relationships between markers (e.g., CD3 vs CD4)
\item Overlaying metadata on any 2D embedding
\item Creating custom QC plots (e.g., library size vs mitochondrial \%)
}

Points are plotted in randomized order (controlled by \code{.seed}) to avoid systematic
overplotting bias when groups overlap.

For numeric \code{.color.feature}, applies a diverging color scale (blue-white-red) centered
at \code{.midpoint} (defaults to median). For categorical features, generates discrete colors
by interpolating \code{.cat.feature.color}.
}
\examples{
\dontrun{
# After processing
lm.cells <- setup.lm.obj(.cells = .cells, .meta = .meta) |>
  get.landmarks() |> get.graph()

# Plot PC1 vs PC2 colored by cluster
scatterPlot(.x.feature = lm.cells$pca$embed[,"PC1"],
            .y.feature = lm.cells$pca$embed[,"PC2"],
            .color.feature = lm.cells$graph$clustering$ids,
            .x.label = "PC1", .y.label = "PC2",
            .color.label = "Cluster")

# Marker expression relationship
scatterPlot(.x.feature = lm.cells$scaled.lm[,"CD4"],
            .y.feature = lm.cells$scaled.lm[,"CD8A"],
            .color.feature = .meta$Condition,
            .x.label = "CD4", .y.label = "CD8A",
            .color.label = "Condition")

# Laplacian Eigenmap coordinates
scatterPlot(.x.feature = lm.cells$graph$LE$embed[,1],
            .y.feature = lm.cells$graph$LE$embed[,2],
            .color.feature = lm.cells$graph$clustering$ids,
            .x.label = "LE1", .y.label = "LE2")
}

}
\seealso{
\code{\link{plotPCA}}, \code{\link{plotUMAP}}
}
