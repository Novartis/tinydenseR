% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.R
\name{plotPCA}
\alias{plotPCA}
\title{Plot PCA}
\usage{
plotPCA(
  .lm.obj,
  .PC.x = 1,
  .PC.y = 2,
  .feature = .lm.obj$graph$clustering$ids,
  .cat.feature.color = Color.Palette[1, 1:5],
  .panel.size = if (is.numeric(x = .feature)) 2 else 3,
  .midpoint = NULL,
  .plot.title = "",
  .color.label = "",
  .legend.position = "right",
  .point.size = 0.1,
  .seed = 123,
  .hover.stats = "none"
)
}
\arguments{
\item{.lm.obj}{A tinydenseR object with PCA computed via \code{get.landmarks()}.}

\item{.PC.x}{Integer specifying x-axis principal component (default 1).}

\item{.PC.y}{Integer specifying y-axis principal component (default 2).}

\item{.feature}{Numeric vector or factor of length \code{nrow(.lm.obj$lm)} to color points by.
Defaults to cluster IDs from \code{$graph$clustering$ids}. Can be:
\itemize{
\item Numeric: gene expression, fold changes, statistics (uses diverging color scale)
\item Factor: clusters, cell types, conditions (uses discrete color palette)
}}

\item{.cat.feature.color}{Character vector of colors for categorical features. Default uses
\code{Color.Palette[1,1:5]} (5-color palette, interpolated to match factor levels).}

\item{.panel.size}{Numeric panel width/height in inches. Default 2 for numeric, 3 for categorical
(to accommodate legend).}

\item{.midpoint}{Numeric midpoint for diverging color scale (continuous features only).
Defaults to median of \code{.feature}.}

\item{.plot.title}{Character plot title (default "").}

\item{.color.label}{Character legend title (default "").}

\item{.legend.position}{Character legend position: "right" (default), "left", "top", "bottom", or "none".}

\item{.point.size}{Numeric point size (default 0.1).}

\item{.seed}{Integer random seed for plot point ordering (default 123).}

\item{.hover.stats}{Character specifying hover information: "none" (default) or "marker" (shows
landmark feature signatures from \code{get.lm.features.stats()}). Requires \pkg{ggiraph}.}
}
\value{
Plot object (class depends on interactivity):
\describe{
\item{Static ggplot}{\code{.hover.stats = "none"} returns a \code{ggplot} object}
\item{Interactive girafe}{\code{.hover.stats != "none"} returns a \code{girafe} object (if \pkg{ggiraph} installed), otherwise falls back to static \code{ggplot} with warning}
}
}
\description{
Visualizes landmarks in PCA space with flexible coloring by features, clusters, or statistical
results. Supports both continuous (e.g., gene expression, fold changes) and categorical
(e.g., clusters, cell types) overlays. Optional interactive hover shows landmark feature signatures.
}
\note{
Interactive hover features require the \pkg{ggiraph} package. Install with
\code{install.packages("ggiraph")}.
}
\examples{
\dontrun{
# From README: Basic PCA visualization
lm.cells <- setup.lm.obj(.cells = .cells, .meta = .meta) |>
  get.landmarks(.nHVG = 500, .nPC = 3) |>
  get.graph()

plotPCA(lm.cells, .point.size = 1, .panel.size = 1.5)

# Color by fold change from get.stats()
condition.stats <- get.stats(lm.cells, .design = design)
plotPCA(lm.cells, 
        .feature = condition.stats$fit$coefficients[,"ConditionB"],
        .color.label = "log2 FC", 
        .midpoint = 0)

# Interactive with feature hover
lm.cells <- get.lm.features.stats(lm.cells)
plotPCA(lm.cells, .hover.stats = "marker")
}

}
\seealso{
\code{\link{plotUMAP}} for UMAP visualization, \code{\link{get.lm.features.stats}}
for hover feature computation
}
