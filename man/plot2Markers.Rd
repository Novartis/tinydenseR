% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.R
\name{plot2Markers}
\alias{plot2Markers}
\title{Bidimensional Hexbin Plot for Marker Expression}
\usage{
plot2Markers(
  .lm.obj,
  .id = NULL,
  .id.from = "clustering",
  .x.feature = "CD3",
  .y.feature = "CD20",
  .bins = 128,
  .legend.position = "right",
  .plot.title = "",
  .panel.size = 1.5,
  .reference = TRUE,
  .density.bins = 32,
  .sd.range = c(-3, 6)
)
}
\arguments{
\item{.lm.obj}{A tinydenseR object processed through \code{get.landmarks()} and \code{get.graph()}.}

\item{.id}{Optional character: cluster or celltype ID to highlight. If NULL (default), plots all landmarks.}

\item{.id.from}{Character: "clustering" (default) or "celltyping". Source of \code{.id}.}

\item{.x.feature}{Character: column name from \code{.lm.obj$lm} for x-axis (default "CD3").}

\item{.y.feature}{Character: column name from \code{.lm.obj$lm} for y-axis (default "CD20").}

\item{.bins}{Integer: number of hexagonal bins for main plot (default 128). Higher values = finer resolution.}

\item{.legend.position}{Character: "right" (default), "left", "top", "bottom", or "none".}

\item{.plot.title}{Character: plot title (default "").}

\item{.panel.size}{Numeric: panel width/height in inches (default 1.5).}

\item{.reference}{Logical: if TRUE (default) and \code{.id} is specified, overlay reference density
contours from all landmarks for comparison.}

\item{.density.bins}{Integer: number of bins for reference density contours (default 32).}

\item{.sd.range}{Numeric vector: range of standard deviations for outlier exclusion (default c(-3, 6)).
Currently not implemented in the function.}
}
\value{
A \code{ggplot} object with hexagonal binning showing marker coexpression.
}
\description{
Creates hexagonal binning plots to visualize the joint distribution of two markers across
landmarks. Useful for exploring marker coexpression patterns and identifying cell populations.
Optionally overlays reference density from all landmarks when plotting a specific cluster/celltype.
}
\details{
The function creates a hexagonal heatmap where:
\itemize{
\item Each hexagon represents a bin in 2D marker expression space
\item Color intensity (red gradient) indicates cell density (log2 scale)
\item For cytometry data, expression values are divided by 50 for scaling
\item When \code{.id} is specified and \code{.reference = TRUE}, gray density contours
show the distribution of all landmarks for context
}

This visualization helps identify:
\itemize{
\item Marker coexpression patterns (e.g., CD3+CD4+ vs CD3+CD8+ populations)
\item Whether a cluster is truly distinct from the background
\item Outlier populations in marker expression space
}
}
\examples{
\dontrun{
# After landmark identification and graph construction
lm.cells <- setup.lm.obj(.cells = .cells, .meta = .meta) |>
  get.landmarks() |>
  get.graph()

# All landmarks
plot2Markers(lm.cells, .x.feature = "CD3", .y.feature = "CD4")

# Specific cluster with reference density
plot2Markers(lm.cells, 
             .id = "1", 
             .x.feature = "CD3", 
             .y.feature = "CD8",
             .reference = TRUE)
}

}
\seealso{
\code{\link{plotPCA}}, \code{\link{plotUMAP}} for dimensionality reduction visualizations
}
