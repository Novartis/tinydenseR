% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.R
\name{plotUMAP}
\alias{plotUMAP}
\title{Plot UMAP
Plot UMAP}
\usage{
plotUMAP(
  .lm.obj,
  .feature = .lm.obj$graph$clustering$ids,
  .cat.feature.color = Color.Palette[1, 1:5],
  .panel.size = 2,
  .midpoint = NULL,
  .plot.title = "",
  .color.label = "",
  .legend.position = "right",
  .point.size = 0.1,
  .seed = 123,
  .hover.stats = "none",
  .hover.n.features = 10
)
}
\arguments{
\item{.lm.obj}{A tinydenseR object with UMAP computed via \code{get.graph()}.}

\item{.feature}{Numeric vector or factor of length \code{nrow(.lm.obj$lm)} to color points by.
Defaults to cluster IDs from \code{$graph$clustering$ids}. Can be:
\itemize{
\item Numeric: gene expression, fold changes, statistics (uses diverging color scale)
\item Factor: clusters, cell types, conditions (uses discrete color palette)
}}

\item{.cat.feature.color}{Character vector of colors for categorical features. Default uses
\code{Color.Palette[1,1:5]} (5-color palette, interpolated to match factor levels).}

\item{.panel.size}{Numeric panel width/height in inches (default 2).}

\item{.midpoint}{Numeric midpoint for diverging color scale (continuous features only).
Defaults to median of \code{.feature}.}

\item{.plot.title}{Character plot title (default "").}

\item{.color.label}{Character legend title (default "").}

\item{.legend.position}{Character legend position: "right" (default), "left", "top", "bottom", or "none".}

\item{.point.size}{Numeric point size (default 0.1).}

\item{.seed}{Integer random seed for plot point ordering (default 123).}

\item{.hover.stats}{Character specifying hover information: "none" (default) or "marker" (shows
landmark feature signatures from \code{get.lm.features.stats()}). Requires \pkg{ggiraph}.}

\item{.hover.n.features}{Integer number of features per direction in hover (default 10).
Currently not implemented.}
}
\value{
A \code{ggplot} object (static) or \code{girafe} object (interactive, if \pkg{ggiraph}
available and \code{.hover.stats != "none"}).
}
\description{
Visualizes landmarks in UMAP space with flexible coloring by features, clusters, or statistical
results. Supports both continuous (e.g., gene expression, fold changes) and categorical
(e.g., clusters, cell types) overlays. Optional interactive hover shows landmark feature signatures.
Identical interface to \code{plotPCA()} for easy comparison.
}
\note{
Requires \code{get.graph()} to have been run. Interactive hover features require the
\pkg{ggiraph} package. Install with \code{install.packages("ggiraph")}.
}
\examples{
\dontrun{
# After graph construction
lm.cells <- setup.lm.obj(.cells = .cells, .meta = .meta) |>
  get.landmarks() |>
  get.graph()

# Basic UMAP
plotUMAP(lm.cells, .point.size = 1)

# Color by gene expression
plotUMAP(lm.cells, .feature = lm.cells$lm[,"CD4"], .color.label = "CD4")

# Color by fold change from get.stats()
condition.stats <- get.stats(lm.cells, .design = design)
plotUMAP(lm.cells, 
         .feature = condition.stats$fit$coefficients[,"ConditionB"],
         .color.label = "log2 FC", 
         .midpoint = 0)

# Interactive with feature hover
lm.cells <- get.lm.features.stats(lm.cells)
plotUMAP(lm.cells, .hover.stats = "marker")
}

}
\seealso{
\code{\link{plotPCA}} for PCA visualization, \code{\link{get.graph}},
\code{\link{get.lm.features.stats}} for hover feature computation
}
