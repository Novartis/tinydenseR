% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocess.R
\name{get.cells.Seurat5}
\alias{get.cells.Seurat5}
\title{Create .cells object from Seurat v5 object}
\usage{
get.cells.Seurat5(
  .seurat.obj,
  .meta,
  .sample.var,
  .assay = "RNA",
  .layer.pattern = "counts",
  .min.cells.per.sample = 10,
  .compress = FALSE,
  .verbose = TRUE
)
}
\arguments{
\item{.seurat.obj}{A Seurat v5 object containing layered RNA data.}

\item{.meta}{A data frame containing the sample-wise metadata. Row names must be sample names matching elements of the object metadata specified by \code{.sample.var}. Required for filtering valid samples.}

\item{.sample.var}{A character string specifying the metadata column to use for sample identification. This column will be used to split cells into samples.}

\item{.assay}{A character string specifying the assay to use. Default is "RNA".}

\item{.layer.pattern}{A character string specifying the pattern to match layer names. Default is "counts" to match layers containing count data.}

\item{.min.cells.per.sample}{An integer specifying the minimum number of cells required per sample. Samples with fewer cells will be excluded. Default is 10.}

\item{.compress}{A logical specifying whether to compress the RDS files. Default is FALSE for faster I/O.}

\item{.verbose}{A logical specifying whether to print progress messages. Default is TRUE.}
}
\value{
A named list containing the on-disk location of RDS files containing one expression matrix for each sample, suitable for use with setup.lm.obj.
}
\description{
This function facilitates the creation of a .cells object suitable for setup.lm.obj from a Seurat v5 object with layered data.
}
\examples{
\dontrun{
# Fetch example data
trajectory_data <- fetch_trajectory_data()
sim_trajectory.meta <- trajectory_data$meta
sim_trajectory <- trajectory_data$SCE

# Process metadata for tinydenseR format
sim_trajectory.meta <- sim_trajectory.meta[, c("Condition", "Replicate", "Sample")] |>
  unique()
rownames(sim_trajectory.meta) <- sim_trajectory.meta$Sample

# Use the SCE object directly for creating Seurat v5 object
# Extract count data from SCE for subset of samples
sim_trajectory.counts.A_R1 <- 
 SingleCellExperiment::counts(sim_trajectory)[, sim_trajectory@colData$Sample == "A_R1"]
sim_trajectory.counts.B_R1 <- 
 SingleCellExperiment::counts(sim_trajectory)[, sim_trajectory@colData$Sample == "B_R1"]

# Create a Seurat v5 object from the example data
# First, combine the matrices
combined.counts <- cbind(sim_trajectory.counts.A_R1, sim_trajectory.counts.B_R1)

# Create cell metadata
cell.meta <- data.frame(
  sample_id = c(rep("A_R1", ncol(sim_trajectory.counts.A_R1)),
                rep("B_R1", ncol(sim_trajectory.counts.B_R1))),
  row.names = colnames(combined.counts)
)

# Create Seurat object
seurat.obj <- CreateSeuratObject(counts = combined.counts,
                                 meta.data = cell.meta)

# Convert to v5 assay structure if needed
if(packageVersion("Seurat") >= "5.0.0"){
  seurat.obj[["RNA"]] <- as(seurat.obj[["RNA"]], "Assay5")
  seurat.obj <- JoinLayers(seurat.obj)
}

# Create .cells object
cells <- get.cells.Seurat5(.seurat.obj = seurat.obj,
                           .sample.var = "sample_id")

# Use with setup.lm.obj
lm.obj <- setup.lm.obj(.cells = cells,
                       .meta = sim_trajectory.meta[c("A_R1", "B_R1"), ],
                       .assay.type = "RNA")
}
}
